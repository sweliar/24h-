# 办公室会议助手

一个基于阿里云通义听悟API的24小时办公室会议助手，可以实时录音、转写、生成会议摘要并保存到本地。

## 功能特性

- 通过电脑麦克风实时录音
- 使用通义听悟API进行实时语音转文字
- 按本地时间实时保存转写结果
- 支持说话人角色区分
- 自动生成会议摘要（包括段落式、对话式、问答式和思维导图式）
- 生成章节速览和智能纪要
- 自动从OSS链接下载完整会议记录和摘要文件
- 自动保存完整的会议记录和格式化的会议摘要
- 自动下载会议音频文件
- 按日期自动组织会议结果文件
- 定时运行模式，支持上午10:00-12:30和下午13:30-21:00自动运行
- 时间段结束时自动停止录音并处理结果

## 环境要求

- Python 3.6+ 
- 安装依赖包（见下文）

## 安装依赖

1. 首先安装通义听悟SDK：
```bash
pip install nls-1.1.0-py3-none-any.whl
```

2. 安装其他依赖：
```bash
pip install pyaudio aliyun-python-sdk-core requests
```

## 配置本地参数

在`config_local.py`文件中设置以下参数：

```python
# 通义听悟API配置
APP_KEY = 'your_app_key_here'
ACCESS_KEY_ID = 'your_access_key_id_here'
ACCESS_KEY_SECRET = 'your_access_key_secret_here'
```

请将上述参数替换为您自己的阿里云凭证。

## 使用方法

  1. 确保已正确配置`config_local.py`文件
  2. 运行程序：
  ```bash
  python main.py
  ```
  3. 程序将自动按照设定的时间段（上午10:00-12:30，下午13:30-21:00）运行
  4. 在运行时间段内，程序会自动创建实时记录任务并开始录音
  5. 在录音过程中，您可以输入'q'并按Enter键手动停止当前录音，或等待系统在当前时间段结束时自动停止
  6. 录音停止后，程序会自动处理结果并下载完整的会议记录和摘要
  7. 如果是手动停止录音，程序会立即准备并开始新的录音任务
  8. 程序会持续运行，除非主动退出进程，否则不会自动结束，并在每天的运行时间段自动开始新的录音

## 输出文件说明

程序运行后将生成以下文件：

- **实时会议记录_{时间戳}.txt**：实时转写的会议记录，按本地时间戳保存
- **完整会议记录_{时间戳}.txt**：包含发言人识别的完整会议记录
- **会议摘要_{时间戳}.txt**：格式化的会议摘要，包括段落式、对话式、问答式等多种形式
- **转写原始数据_{时间戳}.json**：原始转写结果数据（JSON格式）
- **摘要原始数据_{时间戳}.json**：原始摘要结果数据（JSON格式）
- **章节速览_{时间戳}.json**：会议章节速览数据（JSON格式）
- **智能纪要_{时间戳}.json**：智能纪要数据（JSON格式）
- **会议音频_{时间戳}.mp3**：会议录音文件

## 代码结构

项目采用模块化设计，主要包含以下文件：

1. **main.py**：主程序入口，负责整体流程控制、定时运行逻辑和模块协调
   - 初始化各模块
   - 协调整个会议记录流程
   - 实现定时运行逻辑
   - 控制录音开始和结束时间

2. **api_handler.py**：API交互模块，负责与阿里云通义听悟API通信
   - 初始化AcsClient
   - 创建实时任务
   - 查询任务结果
   - 结束任务

3. **audio_handler.py**：音频处理模块，负责录音和音频流推送
   - 初始化音频参数
   - 开始/停止录音
   - 音频流推送
   - 处理转写结果

4. **file_handler.py**：文件处理模块，负责文件下载和保存
   - 从OSS链接下载文件
   - 保存转写结果
   - 保存会议摘要
   - 处理任务结果文件

5. **config_local.py**：配置文件，包含所有API凭证和参数设置
   - API密钥配置
   - 音频参数设置
   - 功能开关配置
   - 任务参数设置

## 模块职责表

| 模块 | 主要职责 | 文件位置 |
|------|---------|---------| 
| 主程序 | 流程控制与模块协调 | 办公室会议助手.py |
| API处理 | 与阿里云API通信 | api_handler.py |
| 音频处理 | 录音与音频流推送 | audio_handler.py |
| 文件处理 | 文件下载与保存 | file_handler.py |
| 配置管理 | API凭证与参数设置 | config_local.py |

## 注意事项

1. 确保您的网络连接稳定，特别是在进行实时推流和下载文件时
2. 程序默认使用16000Hz的采样率，请确保麦克风支持
3. 任务处理可能需要一定时间，请耐心等待
4. 如遇到权限错误，请检查`config_local.py`中的阿里云凭证是否正确设置
5. 下载文件较大时可能需要较长时间，请确保有足够的磁盘空间

## 常见问题

**Q: 运行程序时提示"请在config_local.py中设置ACCESS_KEY_ID和ACCESS_KEY_SECRET"？**
**A:** 请确保在`config_local.py`文件中正确设置了您的阿里云凭证。

**Q: 下载文件失败怎么办？**
**A:** 请检查您的网络连接，确保网络畅通。程序会显示下载错误信息，您也可以尝试手动使用API返回的OSS链接下载文件。

**Q: 生成的会议摘要不够准确怎么办？**
**A:** 这可能与会议音频质量有关，请确保录音环境安静，发言清晰。此外，您可以根据原始转写结果手动整理摘要。# 24h-
